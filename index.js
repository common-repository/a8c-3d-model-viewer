!function(){"use strict";var e=window.wp.element,t=window.wp.blocks,n=window.wp.i18n,r=window.wp.components,o=function(){return(0,e.createElement)(r.SVG,{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)(r.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M11.572 21.633a.745.745 0 0 0 .779.016c.23-.041.455-.123.663-.245l7-4.118A2 2 0 0 0 21 15.562V8.438a2 2 0 0 0-.986-1.724l-7-4.118a2 2 0 0 0-2.028 0l-7 4.118A2 2 0 0 0 3 8.438v7.124a2 2 0 0 0 .986 1.724l7 4.118c.185.108.383.185.586.229Zm1.152-1.799 6.53-3.841a.502.502 0 0 0 .246-.431V8.438a.502.502 0 0 0-.246-.431l-7-4.118a.502.502 0 0 0-.508 0l-7 4.118-.024.016 7.252 4.013 4.865-2.692a.75.75 0 1 1 .726 1.312l-4.841 2.68v6.498ZM4.5 9.614l6.724 3.722v6.467l-6.477-3.81a.5.5 0 0 1-.247-.431V9.614Z"}))};function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],_n=!0,a=!1;try{for(n=n.call(e);!(_n=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);_n=!0);}catch(e){a=!0,o=e}finally{try{_n||null==n.return||n.return()}finally{if(a)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=window.wp.compose,u=window.wp.blockEditor,d="100%",m="240px",h=(0,r.withNotices)((function(t){var l=t.attributes,h=t.setAttributes,f=t.isSelected,p=t.noticeUI,w=t.toggleSelection,g=l.id,b=l.src,v=l.alt,y=l.width,E=l.height,_=l.autoRotate,x=l.cameraOrbit,U=l.fieldOfView,C=l.widthUnit,S=l.heightUnit,I=l.align,O=(0,e.useRef)(null),k=c((0,e.useState)(x),1)[0],R=c((0,e.useState)(U),1)[0],A=c((0,e.useState)({}),2),B=(A[0],A[1]);function T(e){e&&e.url?h({src:e.url,id:e.id}):h({id:void 0,src:void 0,width:void 0,height:void 0})}function V(e){e!==b&&h({src:e,id:void 0})}function L(e){noticeOperations.removeAllNotices(),noticeOperations.createErrorNotice(e)}function M(e,t){var n=("".concat(e,"Unit"),t);h(a({},e,parseInt(n,10)))}function F(e,t,n,r){var o;h((a(o={},e,"%"===r?t:n),a(o,"".concat(e,"Unit"),r),o))}(0,e.useEffect)((function(){O.current&&O.current.addEventListener("camera-change",(function(e){if("user-interaction"===e.detail.source){var t=e.currentTarget.getFieldOfView(),n=e.currentTarget.getCameraOrbit().toString();B(e.currentTarget.getCameraOrbit()),h({cameraOrbit:n,fieldOfView:t})}}))}),[O]);var P=(0,s.useReducedMotion)(),j=(0,r.__experimentalUseCustomUnits)({availableUnits:["%","px"],defaultValues:{"%":50,px:350}}),D=(0,r.__experimentalUseCustomUnits)({availableUnits:["%","px"],defaultValues:{"%":50,px:350}}),z=(0,s.useInstanceId)(r.__experimentalUnitControl),N="wp-block-a8c-model-viewer-width-".concat(z),H=(0,s.useInstanceId)(r.__experimentalUnitControl),W="wp-block-a8c-model-viewer-height-".concat(H),Z=(0,u.useBlockProps)({className:"wp-block-a8c-model-viewer"});if(!b)return(0,e.createElement)("div",Z,(0,e.createElement)(u.MediaPlaceholder,{icon:(0,e.createElement)(u.BlockIcon,{icon:o}),onSelect:T,onSelectURL:V,accept:"*",allowedTypes:"model",value:l,notices:p,onError:L,labels:{title:(0,n.__)("3D Model"),instructions:(0,n.__)("Show interactive 3D models. Add .gltf or .glb files.")}}));var q=!I||"center"===I||((0,n.isRTL)()?"right"===I:"left"===I),G="center"===I||((0,n.isRTL)()?"left"===I:"right"===I),$=_&&!P?{"auto-rotate":"true"}:{};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(u.BlockControls,{group:"other"},(0,e.createElement)(u.MediaReplaceFlow,{mediaId:g,mediaURL:b,accept:["*"],onSelect:T,onSelectURL:V,onError:L})),(0,e.createElement)(u.InspectorControls,null,(0,e.createElement)(r.PanelBody,{title:(0,n.__)("Settings")},(0,e.createElement)(r.BaseControl,null,(0,e.createElement)(r.Flex,null,(0,e.createElement)(r.FlexItem,null,(0,e.createElement)(r.BaseControl,{label:(0,n.__)("Width"),id:N},(0,e.createElement)(r.__experimentalUnitControl,{id:N,min:"".concat(220).concat("px"),onChange:function(e){return M("width",e)},onUnitChange:function(e){return F("width",50,350,e)},value:"".concat(y).concat(C),units:j}))),(0,e.createElement)(r.FlexItem,null,(0,e.createElement)(r.BaseControl,{label:(0,n.__)("Height"),id:W},(0,e.createElement)(r.__experimentalUnitControl,{id:W,min:"".concat(220).concat("px"),onChange:function(e){return M("height",e)},onUnitChange:function(e){return F("height",50,350,e)},value:"".concat(E).concat(S),units:D}))))),(0,e.createElement)(r.BaseControl,null,(0,e.createElement)(r.TextControl,{type:"text",value:x})),(0,e.createElement)(r.ToggleControl,{label:(0,n.__)("Auto rotate"),onChange:function(e){h({autoRotate:e})},checked:_,help:_&&(0,n.__)("Rotation will always be disabled for users that prefer reduced motion.")}),(0,e.createElement)(r.TextareaControl,{label:(0,n.__)("Alternative text"),value:v,onChange:function(e){h({alt:e})},help:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r.ExternalLink,{href:"https://www.w3.org/WAI/tutorials/images/decision-tree"},(0,n.__)("Describe the 3D model.")),(0,e.createElement)("br",null),(0,n.__)("Leave empty if decorative."))}))),(0,e.createElement)("figure",Z,(0,e.createElement)(r.ResizableBox,{size:{height:E&&S?"".concat(E).concat(S):m,width:y&&C?"".concat(y).concat(C):d},showHandle:f,enable:{top:!1,right:q,bottom:!0,left:G},onResizeStart:function(e,t,n){"left"===t||"right"===t?h({width:parseInt(n.offsetWidth,10),widthUnit:"px"}):"top"!==t&&"bottom"!==t||h({height:parseInt(n.offsetHeight,10),heightUnit:"px"}),w(!1)},onResizeStop:function(e,t,n,r){"left"===t||"right"===t?h({width:parseInt(y+r.width,10)}):"top"!==t&&"bottom"!==t||h({height:parseInt(E+r.height,10)}),w(!0)}},(0,e.createElement)("model-viewer",i({class:"wp-block-a8c-model-viewer__component",ref:O,alt:v,src:b,"camera-orbit":k,"field-of-view":"".concat(R,"deg"),ar:!0,"ar-modes":"webxr scene-viewer quick-look","seamless-poster":!0,"shadow-intensity":"1","camera-controls":!0,"enable-pan":!0},$)))))}));function f(t){var n=t.attributes,r=n.src,o=n.alt,a=n.width,l=n.height,c=n.widthUnit,s=n.heightUnit,h=n.cameraOrbit,f=n.fieldOfView,p=n.autoRotate?{"auto-rotate":"true"}:{};return(0,e.createElement)("figure",u.useBlockProps.save(),(0,e.createElement)("model-viewer",i({class:"wp-block-a8c-model-viewer__component",style:{height:l&&s?"".concat(l).concat(s):m,width:a&&c?"".concat(a).concat(c):d},alt:o,src:r,ar:"true","camera-orbit":h,"field-of-view":f,"ar-modes":"webxr scene-viewer quick-look","seamless-poster":"true","shadow-intensity":"1","camera-controls":"true","enable-pan":"true"},p)))}(0,t.registerBlockType)("a8c/model-viewer",{title:"3D Model",description:(0,n.__)("Show 3D models in an interactive viewer. Add files in .gltf or .glb formats."),category:"widgets",icon:o,attributes:{id:{type:"number"},src:{type:"string",source:"attribute",selector:"model-viewer",attribute:"src"},alt:{type:"string",source:"attribute",selector:"model-viewer",attribute:"alt",default:""},autoRotate:{type:"boolean",default:!1},width:{type:"number"},widthUnit:{type:"string"},height:{type:"number"},heightUnit:{type:"string"},cameraOrbit:{type:"string"},fieldOfView:{type:"number"}},supports:{align:!0},edit:function(t){return(0,e.createElement)(h,t)},save:function(t){return(0,e.createElement)(f,t)}})}();